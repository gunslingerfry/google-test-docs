



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.3.0">
    
    
      
        <title>Defining a Mock Class # - Google Docs Mirror</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/application.572ca0f0.css">
      
      
    
    
      <script src="../../../../assets/javascripts/modernizr.962652e9.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#defining-a-mock-class" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../.." title="Google Docs Mirror" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Google Docs Mirror
              </span>
              <span class="md-header-nav__topic">
                Defining a Mock Class #
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/google/googletest" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Google Test
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../.." title="Google Docs Mirror" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Google Docs Mirror
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/google/googletest" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Google Test
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Google Test
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Google Test
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/Documentation/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/primer/" title="Primer" class="md-nav__link">
      Primer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/advanced/" title="Advanced" class="md-nav__link">
      Advanced
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/XcodeGuide.md" title="Xcode" class="md-nav__link">
      Xcode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/PumpManual.md" title="Pump" class="md-nav__link">
      Pump
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/Pkgconfig.md" title="pkg-config" class="md-nav__link">
      pkg-config
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/samples/" title="Samples" class="md-nav__link">
      Samples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Google Mock
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Google Mock
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Documentation.md" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ForDummies.md" title="For Dummies" class="md-nav__link">
      For Dummies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CheatSheet.md" title="Cheat Sheet" class="md-nav__link">
      Cheat Sheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CookBook.md" title="Cookbook" class="md-nav__link">
      Cookbook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FrequentlyAskedQuestions.md" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../KnownIssues.md" title="Known Issues" class="md-nav__link">
      Known Issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DesignDoc.md" title="Design Doc" class="md-nav__link">
      Design Doc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mocking-a-normal-class" title="Mocking a Normal Class" class="md-nav__link">
    Mocking a Normal Class
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mocking-a-class-template" title="Mocking a Class Template" class="md-nav__link">
    Mocking a Class Template
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#specifying-calling-conventions-for-mock-functions" title="Specifying Calling Conventions for Mock Functions" class="md-nav__link">
    Specifying Calling Conventions for Mock Functions
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="defining-a-mock-class">Defining a Mock Class<a class="headerlink" href="#defining-a-mock-class" title="Permanent link">&para;</a></h1>
<h2 id="mocking-a-normal-class">Mocking a Normal Class<a class="headerlink" href="#mocking-a-normal-class" title="Permanent link">&para;</a></h2>
<p>Given</p>
<pre><code class="cpp">class Foo {
  ...
  virtual ~Foo();
  virtual int GetSize() const = 0;
  virtual string Describe(const char* name) = 0;
  virtual string Describe(int type) = 0;
  virtual bool Process(Bar elem, int count) = 0;
};
</code></pre>

<p>(note that <code>~Foo()</code> <strong>must</strong> be virtual) we can define its mock as</p>
<pre><code class="cpp">#include &quot;gmock/gmock.h&quot;

class MockFoo : public Foo {
  MOCK_CONST_METHOD0(GetSize, int());
  MOCK_METHOD1(Describe, string(const char* name));
  MOCK_METHOD1(Describe, string(int type));
  MOCK_METHOD2(Process, bool(Bar elem, int count));
};
</code></pre>

<p>To create a "nice" mock object which ignores all uninteresting calls,
or a "strict" mock object, which treats them as failures:</p>
<pre><code class="cpp">NiceMock&lt;MockFoo&gt; nice_foo;     // The type is a subclass of MockFoo.
StrictMock&lt;MockFoo&gt; strict_foo; // The type is a subclass of MockFoo.
</code></pre>

<h2 id="mocking-a-class-template">Mocking a Class Template<a class="headerlink" href="#mocking-a-class-template" title="Permanent link">&para;</a></h2>
<p>To mock</p>
<pre><code class="cpp">template &lt;typename Elem&gt;
class StackInterface {
 public:
  ...
  virtual ~StackInterface();
  virtual int GetSize() const = 0;
  virtual void Push(const Elem&amp; x) = 0;
};
</code></pre>

<p>(note that <code>~StackInterface()</code> <strong>must</strong> be virtual) just append <code>_T</code> to the <code>MOCK_*</code> macros:</p>
<pre><code class="cpp">template &lt;typename Elem&gt;
class MockStack : public StackInterface&lt;Elem&gt; {
 public:
  ...
  MOCK_CONST_METHOD0_T(GetSize, int());
  MOCK_METHOD1_T(Push, void(const Elem&amp; x));
};
</code></pre>

<h2 id="specifying-calling-conventions-for-mock-functions">Specifying Calling Conventions for Mock Functions<a class="headerlink" href="#specifying-calling-conventions-for-mock-functions" title="Permanent link">&para;</a></h2>
<p>If your mock function doesn't use the default calling convention, you
can specify it by appending <code>_WITH_CALLTYPE</code> to any of the macros
described in the previous two sections and supplying the calling
convention as the first argument to the macro. For example,</p>
<pre><code class="cpp">  MOCK_METHOD1_WITH_CALLTYPE(STDMETHODCALLTYPE, Foo, bool(int n));
  MOCK_CONST_METHOD2_WITH_CALLTYPE(STDMETHODCALLTYPE, Bar, int(double x, double y));
</code></pre>

<p>where <code>STDMETHODCALLTYPE</code> is defined by <code>&lt;objbase.h&gt;</code> on Windows.</p>
<h1 id="using-mocks-in-tests">Using Mocks in Tests<a class="headerlink" href="#using-mocks-in-tests" title="Permanent link">&para;</a></h1>
<p>The typical flow is:
  1. Import the Google Mock names you need to use. All Google Mock names are in the <code>testing</code> namespace unless they are macros or otherwise noted.
  1. Create the mock objects.
  1. Optionally, set the default actions of the mock objects.
  1. Set your expectations on the mock objects (How will they be called? What wil they do?).
  1. Exercise code that uses the mock objects; if necessary, check the result using <a href="../../googletest/">Google Test</a> assertions.
  1. When a mock objects is destructed, Google Mock automatically verifies that all expectations on it have been satisfied.</p>
<p>Here is an example:</p>
<pre><code class="cpp">using ::testing::Return;                          // #1

TEST(BarTest, DoesThis) {
  MockFoo foo;                                    // #2

  ON_CALL(foo, GetSize())                         // #3
      .WillByDefault(Return(1));
  // ... other default actions ...

  EXPECT_CALL(foo, Describe(5))                   // #4
      .Times(3)
      .WillRepeatedly(Return(&quot;Category 5&quot;));
  // ... other expectations ...

  EXPECT_EQ(&quot;good&quot;, MyProductionFunction(&amp;foo));  // #5
}                                                 // #6
</code></pre>

<h1 id="setting-default-actions">Setting Default Actions<a class="headerlink" href="#setting-default-actions" title="Permanent link">&para;</a></h1>
<p>Google Mock has a <strong>built-in default action</strong> for any function that
returns <code>void</code>, <code>bool</code>, a numeric value, or a pointer.</p>
<p>To customize the default action for functions with return type <code>T</code> globally:</p>
<pre><code class="cpp">using ::testing::DefaultValue;

// Sets the default value to be returned. T must be CopyConstructible.
DefaultValue&lt;T&gt;::Set(value);
// Sets a factory. Will be invoked on demand. T must be MoveConstructible.
//   T MakeT();
DefaultValue&lt;T&gt;::SetFactory(&amp;MakeT);
// ... use the mocks ...
// Resets the default value.
DefaultValue&lt;T&gt;::Clear();
</code></pre>

<p>To customize the default action for a particular method, use <code>ON_CALL()</code>:</p>
<pre><code class="cpp">ON_CALL(mock_object, method(matchers))
    .With(multi_argument_matcher)  ?
    .WillByDefault(action);
</code></pre>

<h1 id="setting-expectations">Setting Expectations<a class="headerlink" href="#setting-expectations" title="Permanent link">&para;</a></h1>
<p><code>EXPECT_CALL()</code> sets <strong>expectations</strong> on a mock method (How will it be
called? What will it do?):</p>
<pre><code class="cpp">EXPECT_CALL(mock_object, method(matchers))
    .With(multi_argument_matcher)  ?
    .Times(cardinality)            ?
    .InSequence(sequences)         *
    .After(expectations)           *
    .WillOnce(action)              *
    .WillRepeatedly(action)        ?
    .RetiresOnSaturation();        ?
</code></pre>

<p>If <code>Times()</code> is omitted, the cardinality is assumed to be:</p>
<ul>
<li><code>Times(1)</code> when there is neither <code>WillOnce()</code> nor <code>WillRepeatedly()</code>;</li>
<li><code>Times(n)</code> when there are <code>n WillOnce()</code>s but no <code>WillRepeatedly()</code>, where <code>n</code> &gt;= 1; or</li>
<li><code>Times(AtLeast(n))</code> when there are <code>n WillOnce()</code>s and a <code>WillRepeatedly()</code>, where <code>n</code> &gt;= 0.</li>
</ul>
<p>A method with no <code>EXPECT_CALL()</code> is free to be invoked <em>any number of times</em>, and the default action will be taken each time.</p>
<h1 id="matchers">Matchers<a class="headerlink" href="#matchers" title="Permanent link">&para;</a></h1>
<p>A <strong>matcher</strong> matches a <em>single</em> argument.  You can use it inside
<code>ON_CALL()</code> or <code>EXPECT_CALL()</code>, or use it to validate a value
directly:</p>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>EXPECT_THAT(value, matcher)</code></td>
<td align="left">Asserts that <code>value</code> matches <code>matcher</code>.</td>
</tr>
<tr>
<td align="left"><code>ASSERT_THAT(value, matcher)</code></td>
<td align="left">The same as <code>EXPECT_THAT(value, matcher)</code>, except that it generates a <strong>fatal</strong> failure.</td>
</tr>
</tbody>
</table>
<p>Built-in matchers (where <code>argument</code> is the function argument) are
divided into several categories:</p>
<h2 id="wildcard">Wildcard<a class="headerlink" href="#wildcard" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>_</code></td>
<td align="left"><code>argument</code> can be any value of the correct type.</td>
</tr>
<tr>
<td align="left"><code>A&lt;type&gt;()</code> or <code>An&lt;type&gt;()</code></td>
<td align="left"><code>argument</code> can be any value of type <code>type</code>.</td>
</tr>
</tbody>
</table>
<h2 id="generic-comparison">Generic Comparison<a class="headerlink" href="#generic-comparison" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Eq(value)</code> or <code>value</code></td>
<td align="left"><code>argument == value</code></td>
</tr>
<tr>
<td align="left"><code>Ge(value)</code></td>
<td align="left"><code>argument &gt;= value</code></td>
</tr>
<tr>
<td align="left"><code>Gt(value)</code></td>
<td align="left"><code>argument &gt; value</code></td>
</tr>
<tr>
<td align="left"><code>Le(value)</code></td>
<td align="left"><code>argument &lt;= value</code></td>
</tr>
<tr>
<td align="left"><code>Lt(value)</code></td>
<td align="left"><code>argument &lt; value</code></td>
</tr>
<tr>
<td align="left"><code>Ne(value)</code></td>
<td align="left"><code>argument != value</code></td>
</tr>
<tr>
<td align="left"><code>IsNull()</code></td>
<td align="left"><code>argument</code> is a <code>NULL</code> pointer (raw or smart).</td>
</tr>
<tr>
<td align="left"><code>NotNull()</code></td>
<td align="left"><code>argument</code> is a non-null pointer (raw or smart).</td>
</tr>
<tr>
<td align="left"><code>Optional(m)</code></td>
<td align="left"><code>argument</code> is <code>optional&lt;&gt;</code> that contains a value matching <code>m</code>.</td>
</tr>
<tr>
<td align="left"><code>VariantWith&lt;T&gt;(m)</code></td>
<td align="left"><code>argument</code> is <code>variant&lt;&gt;</code> that holds the alternative of type T with a value matching <code>m</code>.</td>
</tr>
<tr>
<td align="left"><code>Ref(variable)</code></td>
<td align="left"><code>argument</code> is a reference to <code>variable</code>.</td>
</tr>
<tr>
<td align="left"><code>TypedEq&lt;type&gt;(value)</code></td>
<td align="left"><code>argument</code> has type <code>type</code> and is equal to <code>value</code>. You may need to use this instead of <code>Eq(value)</code> when the mock function is overloaded.</td>
</tr>
</tbody>
</table>
<p>Except <code>Ref()</code>, these matchers make a <em>copy</em> of <code>value</code> in case it's
modified or destructed later. If the compiler complains that <code>value</code>
doesn't have a public copy constructor, try wrap it in <code>ByRef()</code>,
e.g. <code>Eq(ByRef(non_copyable_value))</code>. If you do that, make sure
<code>non_copyable_value</code> is not changed afterwards, or the meaning of your
matcher will be changed.</p>
<h2 id="floating-point-matchers">Floating-Point Matchers<a class="headerlink" href="#floating-point-matchers" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>DoubleEq(a_double)</code></td>
<td align="left"><code>argument</code> is a <code>double</code> value approximately equal to <code>a_double</code>, treating two NaNs as unequal.</td>
</tr>
<tr>
<td align="left"><code>FloatEq(a_float)</code></td>
<td align="left"><code>argument</code> is a <code>float</code> value approximately equal to <code>a_float</code>, treating two NaNs as unequal.</td>
</tr>
<tr>
<td align="left"><code>NanSensitiveDoubleEq(a_double)</code></td>
<td align="left"><code>argument</code> is a <code>double</code> value approximately equal to <code>a_double</code>, treating two NaNs as equal.</td>
</tr>
<tr>
<td align="left"><code>NanSensitiveFloatEq(a_float)</code></td>
<td align="left"><code>argument</code> is a <code>float</code> value approximately equal to <code>a_float</code>, treating two NaNs as equal.</td>
</tr>
</tbody>
</table>
<p>The above matchers use ULP-based comparison (the same as used in
<a href="../../googletest/">Google Test</a>). They
automatically pick a reasonable error bound based on the absolute
value of the expected value.  <code>DoubleEq()</code> and <code>FloatEq()</code> conform to
the IEEE standard, which requires comparing two NaNs for equality to
return false. The <code>NanSensitive*</code> version instead treats two NaNs as
equal, which is often what a user wants.</p>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>DoubleNear(a_double, max_abs_error)</code></td>
<td align="left"><code>argument</code> is a <code>double</code> value close to <code>a_double</code> (absolute error &lt;= <code>max_abs_error</code>), treating two NaNs as unequal.</td>
</tr>
<tr>
<td align="left"><code>FloatNear(a_float, max_abs_error)</code></td>
<td align="left"><code>argument</code> is a <code>float</code> value close to <code>a_float</code> (absolute error &lt;= <code>max_abs_error</code>), treating two NaNs as unequal.</td>
</tr>
<tr>
<td align="left"><code>NanSensitiveDoubleNear(a_double, max_abs_error)</code></td>
<td align="left"><code>argument</code> is a <code>double</code> value close to <code>a_double</code> (absolute error &lt;= <code>max_abs_error</code>), treating two NaNs as equal.</td>
</tr>
<tr>
<td align="left"><code>NanSensitiveFloatNear(a_float, max_abs_error)</code></td>
<td align="left"><code>argument</code> is a <code>float</code> value close to <code>a_float</code> (absolute error &lt;= <code>max_abs_error</code>), treating two NaNs as equal.</td>
</tr>
</tbody>
</table>
<h2 id="string-matchers">String Matchers<a class="headerlink" href="#string-matchers" title="Permanent link">&para;</a></h2>
<p>The <code>argument</code> can be either a C string or a C++ string object:</p>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>ContainsRegex(string)</code></td>
<td align="left"><code>argument</code> matches the given regular expression.</td>
</tr>
<tr>
<td align="left"><code>EndsWith(suffix)</code></td>
<td align="left"><code>argument</code> ends with string <code>suffix</code>.</td>
</tr>
<tr>
<td align="left"><code>HasSubstr(string)</code></td>
<td align="left"><code>argument</code> contains <code>string</code> as a sub-string.</td>
</tr>
<tr>
<td align="left"><code>MatchesRegex(string)</code></td>
<td align="left"><code>argument</code> matches the given regular expression with the match starting at the first character and ending at the last character.</td>
</tr>
<tr>
<td align="left"><code>StartsWith(prefix)</code></td>
<td align="left"><code>argument</code> starts with string <code>prefix</code>.</td>
</tr>
<tr>
<td align="left"><code>StrCaseEq(string)</code></td>
<td align="left"><code>argument</code> is equal to <code>string</code>, ignoring case.</td>
</tr>
<tr>
<td align="left"><code>StrCaseNe(string)</code></td>
<td align="left"><code>argument</code> is not equal to <code>string</code>, ignoring case.</td>
</tr>
<tr>
<td align="left"><code>StrEq(string)</code></td>
<td align="left"><code>argument</code> is equal to <code>string</code>.</td>
</tr>
<tr>
<td align="left"><code>StrNe(string)</code></td>
<td align="left"><code>argument</code> is not equal to <code>string</code>.</td>
</tr>
</tbody>
</table>
<p><code>ContainsRegex()</code> and <code>MatchesRegex()</code> use the regular expression
syntax defined
<a href="../../../googletest/docs/advanced/#regular-expression-syntax">here</a>.
<code>StrCaseEq()</code>, <code>StrCaseNe()</code>, <code>StrEq()</code>, and <code>StrNe()</code> work for wide
strings as well.</p>
<h2 id="container-matchers">Container Matchers<a class="headerlink" href="#container-matchers" title="Permanent link">&para;</a></h2>
<p>Most STL-style containers support <code>==</code>, so you can use
<code>Eq(expected_container)</code> or simply <code>expected_container</code> to match a
container exactly.   If you want to write the elements in-line,
match them more flexibly, or get more informative messages, you can use:</p>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>ContainerEq(container)</code></td>
<td align="left">The same as <code>Eq(container)</code> except that the failure message also includes which elements are in one container but not the other.</td>
</tr>
<tr>
<td align="left"><code>Contains(e)</code></td>
<td align="left"><code>argument</code> contains an element that matches <code>e</code>, which can be either a value or a matcher.</td>
</tr>
<tr>
<td align="left"><code>Each(e)</code></td>
<td align="left"><code>argument</code> is a container where <em>every</em> element matches <code>e</code>, which can be either a value or a matcher.</td>
</tr>
<tr>
<td align="left"><code>ElementsAre(e0, e1, ..., en)</code></td>
<td align="left"><code>argument</code> has <code>n + 1</code> elements, where the i-th element matches <code>ei</code>, which can be a value or a matcher. 0 to 10 arguments are allowed.</td>
</tr>
<tr>
<td align="left"><code>ElementsAreArray({ e0, e1, ..., en })</code>, <code>ElementsAreArray(array)</code>, or <code>ElementsAreArray(array, count)</code></td>
<td align="left">The same as <code>ElementsAre()</code> except that the expected element values/matchers come from an initializer list, STL-style container, or C-style array.</td>
</tr>
<tr>
<td align="left"><code>IsEmpty()</code></td>
<td align="left"><code>argument</code> is an empty container (<code>container.empty()</code>).</td>
</tr>
<tr>
<td align="left"><code>Pointwise(m, container)</code></td>
<td align="left"><code>argument</code> contains the same number of elements as in <code>container</code>, and for all i, (the i-th element in <code>argument</code>, the i-th element in <code>container</code>) match <code>m</code>, which is a matcher on 2-tuples. E.g. <code>Pointwise(Le(), upper_bounds)</code> verifies that each element in <code>argument</code> doesn't exceed the corresponding element in <code>upper_bounds</code>. See more detail below.</td>
</tr>
<tr>
<td align="left"><code>SizeIs(m)</code></td>
<td align="left"><code>argument</code> is a container whose size matches <code>m</code>. E.g. <code>SizeIs(2)</code> or <code>SizeIs(Lt(2))</code>.</td>
</tr>
<tr>
<td align="left"><code>UnorderedElementsAre(e0, e1, ..., en)</code></td>
<td align="left"><code>argument</code> has <code>n + 1</code> elements, and under some permutation each element matches an <code>ei</code> (for a different <code>i</code>), which can be a value or a matcher. 0 to 10 arguments are allowed.</td>
</tr>
<tr>
<td align="left"><code>UnorderedElementsAreArray({ e0, e1, ..., en })</code>, <code>UnorderedElementsAreArray(array)</code>, or <code>UnorderedElementsAreArray(array, count)</code></td>
<td align="left">The same as <code>UnorderedElementsAre()</code> except that the expected element values/matchers come from an initializer list, STL-style container, or C-style array.</td>
</tr>
<tr>
<td align="left"><code>WhenSorted(m)</code></td>
<td align="left">When <code>argument</code> is sorted using the <code>&lt;</code> operator, it matches container matcher <code>m</code>. E.g. <code>WhenSorted(ElementsAre(1, 2, 3))</code> verifies that <code>argument</code> contains elements <code>1</code>, <code>2</code>, and <code>3</code>, ignoring order.</td>
</tr>
<tr>
<td align="left"><code>WhenSortedBy(comparator, m)</code></td>
<td align="left">The same as <code>WhenSorted(m)</code>, except that the given comparator instead of <code>&lt;</code> is used to sort <code>argument</code>. E.g. <code>WhenSortedBy(std::greater&lt;int&gt;(), ElementsAre(3, 2, 1))</code>.</td>
</tr>
</tbody>
</table>
<p>Notes:</p>
<ul>
<li>These matchers can also match:<ol>
<li>a native array passed by reference (e.g. in <code>Foo(const int (&amp;a)[5])</code>), and</li>
<li>an array passed as a pointer and a count (e.g. in <code>Bar(const T* buffer, int len)</code> -- see <a href="#multiargument-matchers">Multi-argument Matchers</a>).</li>
</ol>
</li>
<li>The array being matched may be multi-dimensional (i.e. its elements can be arrays).</li>
<li><code>m</code> in <code>Pointwise(m, ...)</code> should be a matcher for <code>::testing::tuple&lt;T, U&gt;</code> where <code>T</code> and <code>U</code> are the element type of the actual container and the expected container, respectively. For example, to compare two <code>Foo</code> containers where <code>Foo</code> doesn't support <code>operator==</code> but has an <code>Equals()</code> method, one might write:</li>
</ul>
<pre><code class="cpp">using ::testing::get;
MATCHER(FooEq, &quot;&quot;) {
  return get&lt;0&gt;(arg).Equals(get&lt;1&gt;(arg));
}
...
EXPECT_THAT(actual_foos, Pointwise(FooEq(), expected_foos));
</code></pre>

<h2 id="member-matchers">Member Matchers<a class="headerlink" href="#member-matchers" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Field(&amp;class::field, m)</code></td>
<td align="left"><code>argument.field</code> (or <code>argument-&gt;field</code> when <code>argument</code> is a plain pointer) matches matcher <code>m</code>, where <code>argument</code> is an object of type <em>class</em>.</td>
</tr>
<tr>
<td align="left"><code>Key(e)</code></td>
<td align="left"><code>argument.first</code> matches <code>e</code>, which can be either a value or a matcher. E.g. <code>Contains(Key(Le(5)))</code> can verify that a <code>map</code> contains a key <code>&lt;= 5</code>.</td>
</tr>
<tr>
<td align="left"><code>Pair(m1, m2)</code></td>
<td align="left"><code>argument</code> is an <code>std::pair</code> whose <code>first</code> field matches <code>m1</code> and <code>second</code> field matches <code>m2</code>.</td>
</tr>
<tr>
<td align="left"><code>Property(&amp;class::property, m)</code></td>
<td align="left"><code>argument.property()</code> (or <code>argument-&gt;property()</code> when <code>argument</code> is a plain pointer) matches matcher <code>m</code>, where <code>argument</code> is an object of type <em>class</em>.</td>
</tr>
</tbody>
</table>
<h2 id="matching-the-result-of-a-function-or-functor">Matching the Result of a Function or Functor<a class="headerlink" href="#matching-the-result-of-a-function-or-functor" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>ResultOf(f, m)</code></td>
<td align="left"><code>f(argument)</code> matches matcher <code>m</code>, where <code>f</code> is a function or functor.</td>
</tr>
</tbody>
</table>
<h2 id="pointer-matchers">Pointer Matchers<a class="headerlink" href="#pointer-matchers" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Pointee(m)</code></td>
<td align="left"><code>argument</code> (either a smart pointer or a raw pointer) points to a value that matches matcher <code>m</code>.</td>
</tr>
<tr>
<td align="left"><code>WhenDynamicCastTo&lt;T&gt;(m)</code></td>
<td align="left">when <code>argument</code> is passed through <code>dynamic_cast&lt;T&gt;()</code>, it matches matcher <code>m</code>.</td>
</tr>
</tbody>
</table>
<h2 id="multiargument-matchers">Multiargument Matchers<a class="headerlink" href="#multiargument-matchers" title="Permanent link">&para;</a></h2>
<p>Technically, all matchers match a <em>single</em> value. A "multi-argument"
matcher is just one that matches a <em>tuple</em>. The following matchers can
be used to match a tuple <code>(x, y)</code>:</p>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Eq()</code></td>
<td align="left"><code>x == y</code></td>
</tr>
<tr>
<td align="left"><code>Ge()</code></td>
<td align="left"><code>x &gt;= y</code></td>
</tr>
<tr>
<td align="left"><code>Gt()</code></td>
<td align="left"><code>x &gt; y</code></td>
</tr>
<tr>
<td align="left"><code>Le()</code></td>
<td align="left"><code>x &lt;= y</code></td>
</tr>
<tr>
<td align="left"><code>Lt()</code></td>
<td align="left"><code>x &lt; y</code></td>
</tr>
<tr>
<td align="left"><code>Ne()</code></td>
<td align="left"><code>x != y</code></td>
</tr>
</tbody>
</table>
<p>You can use the following selectors to pick a subset of the arguments
(or reorder them) to participate in the matching:</p>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>AllArgs(m)</code></td>
<td align="left">Equivalent to <code>m</code>. Useful as syntactic sugar in <code>.With(AllArgs(m))</code>.</td>
</tr>
<tr>
<td align="left"><code>Args&lt;N1, N2, ..., Nk&gt;(m)</code></td>
<td align="left">The tuple of the <code>k</code> selected (using 0-based indices) arguments matches <code>m</code>, e.g. <code>Args&lt;1, 2&gt;(Eq())</code>.</td>
</tr>
</tbody>
</table>
<h2 id="composite-matchers">Composite Matchers<a class="headerlink" href="#composite-matchers" title="Permanent link">&para;</a></h2>
<p>You can make a matcher from one or more other matchers:</p>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>AllOf(m1, m2, ..., mn)</code></td>
<td align="left"><code>argument</code> matches all of the matchers <code>m1</code> to <code>mn</code>.</td>
</tr>
<tr>
<td align="left"><code>AnyOf(m1, m2, ..., mn)</code></td>
<td align="left"><code>argument</code> matches at least one of the matchers <code>m1</code> to <code>mn</code>.</td>
</tr>
<tr>
<td align="left"><code>Not(m)</code></td>
<td align="left"><code>argument</code> doesn't match matcher <code>m</code>.</td>
</tr>
</tbody>
</table>
<h2 id="adapters-for-matchers">Adapters for Matchers<a class="headerlink" href="#adapters-for-matchers" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>MatcherCast&lt;T&gt;(m)</code></td>
<td align="left">casts matcher <code>m</code> to type <code>Matcher&lt;T&gt;</code>.</td>
</tr>
<tr>
<td align="left"><code>SafeMatcherCast&lt;T&gt;(m)</code></td>
<td align="left"><a href="../cook_book/#casting-matchers">safely casts</a> matcher <code>m</code> to type <code>Matcher&lt;T&gt;</code>.</td>
</tr>
<tr>
<td align="left"><code>Truly(predicate)</code></td>
<td align="left"><code>predicate(argument)</code> returns something considered by C++ to be true, where <code>predicate</code> is a function or functor.</td>
</tr>
</tbody>
</table>
<h2 id="matchers-as-predicates">Matchers as Predicates<a class="headerlink" href="#matchers-as-predicates" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Matches(m)(value)</code></td>
<td align="left">evaluates to <code>true</code> if <code>value</code> matches <code>m</code>. You can use <code>Matches(m)</code> alone as a unary functor.</td>
</tr>
<tr>
<td align="left"><code>ExplainMatchResult(m, value, result_listener)</code></td>
<td align="left">evaluates to <code>true</code> if <code>value</code> matches <code>m</code>, explaining the result to <code>result_listener</code>.</td>
</tr>
<tr>
<td align="left"><code>Value(value, m)</code></td>
<td align="left">evaluates to <code>true</code> if <code>value</code> matches <code>m</code>.</td>
</tr>
</tbody>
</table>
<h2 id="defining-matchers">Defining Matchers<a class="headerlink" href="#defining-matchers" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>MATCHER(IsEven, "") { return (arg % 2) == 0; }</code></td>
<td align="left">Defines a matcher <code>IsEven()</code> to match an even number.</td>
</tr>
<tr>
<td align="left"><code>MATCHER_P(IsDivisibleBy, n, "") { *result_listener &lt;&lt; "where the remainder is " &lt;&lt; (arg % n); return (arg % n) == 0; }</code></td>
<td align="left">Defines a macher <code>IsDivisibleBy(n)</code> to match a number divisible by <code>n</code>.</td>
</tr>
<tr>
<td align="left"><code>MATCHER_P2(IsBetween, a, b, std::string(negation ? "isn't" : "is") + " between " + PrintToString(a) + " and " + PrintToString(b)) { return a &lt;= arg &amp;&amp; arg &lt;= b; }</code></td>
<td align="left">Defines a matcher <code>IsBetween(a, b)</code> to match a value in the range [<code>a</code>, <code>b</code>].</td>
</tr>
</tbody>
</table>
<p><strong>Notes:</strong></p>
<ol>
<li>The <code>MATCHER*</code> macros cannot be used inside a function or class.</li>
<li>The matcher body must be <em>purely functional</em> (i.e. it cannot have any side effect, and the result must not depend on anything other than the value being matched and the matcher parameters).</li>
<li>You can use <code>PrintToString(x)</code> to convert a value <code>x</code> of any type to a string.</li>
</ol>
<h2 id="matchers-as-test-assertions">Matchers as Test Assertions<a class="headerlink" href="#matchers-as-test-assertions" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>ASSERT_THAT(expression, m)</code></td>
<td align="left">Generates a <a href="../../../googletest/docs/primer/#assertions">fatal failure</a> if the value of <code>expression</code> doesn't match matcher <code>m</code>.</td>
</tr>
<tr>
<td align="left"><code>EXPECT_THAT(expression, m)</code></td>
<td align="left">Generates a non-fatal failure if the value of <code>expression</code> doesn't match matcher <code>m</code>.</td>
</tr>
</tbody>
</table>
<h1 id="actions">Actions<a class="headerlink" href="#actions" title="Permanent link">&para;</a></h1>
<p><strong>Actions</strong> specify what a mock function should do when invoked.</p>
<h2 id="returning-a-value">Returning a Value<a class="headerlink" href="#returning-a-value" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Return()</code></td>
<td align="left">Return from a <code>void</code> mock function.</td>
</tr>
<tr>
<td align="left"><code>Return(value)</code></td>
<td align="left">Return <code>value</code>. If the type of <code>value</code> is different to the mock function's return type, <code>value</code> is converted to the latter type <i>at the time the expectation is set</i>, not when the action is executed.</td>
</tr>
<tr>
<td align="left"><code>ReturnArg&lt;N&gt;()</code></td>
<td align="left">Return the <code>N</code>-th (0-based) argument.</td>
</tr>
<tr>
<td align="left"><code>ReturnNew&lt;T&gt;(a1, ..., ak)</code></td>
<td align="left">Return <code>new T(a1, ..., ak)</code>; a different object is created each time.</td>
</tr>
<tr>
<td align="left"><code>ReturnNull()</code></td>
<td align="left">Return a null pointer.</td>
</tr>
<tr>
<td align="left"><code>ReturnPointee(ptr)</code></td>
<td align="left">Return the value pointed to by <code>ptr</code>.</td>
</tr>
<tr>
<td align="left"><code>ReturnRef(variable)</code></td>
<td align="left">Return a reference to <code>variable</code>.</td>
</tr>
<tr>
<td align="left"><code>ReturnRefOfCopy(value)</code></td>
<td align="left">Return a reference to a copy of <code>value</code>; the copy lives as long as the action.</td>
</tr>
</tbody>
</table>
<h2 id="side-effects">Side Effects<a class="headerlink" href="#side-effects" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Assign(&amp;variable, value)</code></td>
<td align="left">Assign <code>value</code> to variable.</td>
</tr>
<tr>
<td align="left"><code>DeleteArg&lt;N&gt;()</code></td>
<td align="left">Delete the <code>N</code>-th (0-based) argument, which must be a pointer.</td>
</tr>
<tr>
<td align="left"><code>SaveArg&lt;N&gt;(pointer)</code></td>
<td align="left">Save the <code>N</code>-th (0-based) argument to <code>*pointer</code>.</td>
</tr>
<tr>
<td align="left"><code>SaveArgPointee&lt;N&gt;(pointer)</code></td>
<td align="left">Save the value pointed to by the <code>N</code>-th (0-based) argument to <code>*pointer</code>.</td>
</tr>
<tr>
<td align="left"><code>SetArgReferee&lt;N&gt;(value)</code></td>
<td align="left">Assign value to the variable referenced by the <code>N</code>-th (0-based) argument.</td>
</tr>
<tr>
<td align="left"><code>SetArgPointee&lt;N&gt;(value)</code></td>
<td align="left">Assign <code>value</code> to the variable pointed by the <code>N</code>-th (0-based) argument.</td>
</tr>
<tr>
<td align="left"><code>SetArgumentPointee&lt;N&gt;(value)</code></td>
<td align="left">Same as <code>SetArgPointee&lt;N&gt;(value)</code>. Deprecated. Will be removed in v1.7.0.</td>
</tr>
<tr>
<td align="left"><code>SetArrayArgument&lt;N&gt;(first, last)</code></td>
<td align="left">Copies the elements in source range [<code>first</code>, <code>last</code>) to the array pointed to by the <code>N</code>-th (0-based) argument, which can be either a pointer or an iterator. The action does not take ownership of the elements in the source range.</td>
</tr>
<tr>
<td align="left"><code>SetErrnoAndReturn(error, value)</code></td>
<td align="left">Set <code>errno</code> to <code>error</code> and return <code>value</code>.</td>
</tr>
<tr>
<td align="left"><code>Throw(exception)</code></td>
<td align="left">Throws the given exception, which can be any copyable value. Available since v1.1.0.</td>
</tr>
</tbody>
</table>
<h2 id="using-a-function-or-a-functor-as-an-action">Using a Function or a Functor as an Action<a class="headerlink" href="#using-a-function-or-a-functor-as-an-action" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Invoke(f)</code></td>
<td align="left">Invoke <code>f</code> with the arguments passed to the mock function, where <code>f</code> can be a global/static function or a functor.</td>
</tr>
<tr>
<td align="left"><code>Invoke(object_pointer, &amp;class::method)</code></td>
<td align="left">Invoke the {method on the object with the arguments passed to the mock function.</td>
</tr>
<tr>
<td align="left"><code>InvokeWithoutArgs(f)</code></td>
<td align="left">Invoke <code>f</code>, which can be a global/static function or a functor. <code>f</code> must take no arguments.</td>
</tr>
<tr>
<td align="left"><code>InvokeWithoutArgs(object_pointer, &amp;class::method)</code></td>
<td align="left">Invoke the method on the object, which takes no arguments.</td>
</tr>
<tr>
<td align="left"><code>InvokeArgument&lt;N&gt;(arg1, arg2, ..., argk)</code></td>
<td align="left">Invoke the mock function's <code>N</code>-th (0-based) argument, which must be a function or a functor, with the <code>k</code> arguments.</td>
</tr>
</tbody>
</table>
<p>The return value of the invoked function is used as the return value
of the action.</p>
<p>When defining a function or functor to be used with <code>Invoke*()</code>, you can declare any unused parameters as <code>Unused</code>:</p>
<pre><code class="cpp">  double Distance(Unused, double x, double y) { return sqrt(x*x + y*y); }
  ...
  EXPECT_CALL(mock, Foo(&quot;Hi&quot;, _, _)).WillOnce(Invoke(Distance));
</code></pre>

<p>In <code>InvokeArgument&lt;N&gt;(...)</code>, if an argument needs to be passed by reference, wrap it inside <code>ByRef()</code>. For example,</p>
<pre><code class="cpp">  InvokeArgument&lt;2&gt;(5, string(&quot;Hi&quot;), ByRef(foo))
</code></pre>

<p>calls the mock function's #2 argument, passing to it <code>5</code> and <code>string("Hi")</code> by value, and <code>foo</code> by reference.</p>
<h2 id="default-action">Default Action<a class="headerlink" href="#default-action" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>DoDefault()</code></td>
<td align="left">Do the default action (specified by <code>ON_CALL()</code> or the built-in one).</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> due to technical reasons, <code>DoDefault()</code> cannot be used inside  a composite action - trying to do so will result in a run-time error.</p>
<h2 id="composite-actions">Composite Actions<a class="headerlink" href="#composite-actions" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>DoAll(a1, a2, ..., an)</code></td>
<td align="left">Do all actions <code>a1</code> to <code>an</code> and return the result of <code>an</code> in each invocation. The first <code>n - 1</code> sub-actions must return void.</td>
</tr>
<tr>
<td align="left"><code>IgnoreResult(a)</code></td>
<td align="left">Perform action <code>a</code> and ignore its result. <code>a</code> must not return void.</td>
</tr>
<tr>
<td align="left"><code>WithArg&lt;N&gt;(a)</code></td>
<td align="left">Pass the <code>N</code>-th (0-based) argument of the mock function to action <code>a</code> and perform it.</td>
</tr>
<tr>
<td align="left"><code>WithArgs&lt;N1, N2, ..., Nk&gt;(a)</code></td>
<td align="left">Pass the selected (0-based) arguments of the mock function to action <code>a</code> and perform it.</td>
</tr>
<tr>
<td align="left"><code>WithoutArgs(a)</code></td>
<td align="left">Perform action <code>a</code> without any arguments.</td>
</tr>
</tbody>
</table>
<h2 id="defining-actions">Defining Actions<a class="headerlink" href="#defining-actions" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>ACTION(Sum) { return arg0 + arg1; }</code></td>
<td align="left">Defines an action <code>Sum()</code> to return the sum of the mock function's argument #0 and #1.</td>
</tr>
<tr>
<td align="left"><code>ACTION_P(Plus, n) { return arg0 + n; }</code></td>
<td align="left">Defines an action <code>Plus(n)</code> to return the sum of the mock function's argument #0 and <code>n</code>.</td>
</tr>
<tr>
<td align="left"><code>ACTION_Pk(Foo, p1, ..., pk) { statements; }</code></td>
<td align="left">Defines a parameterized action <code>Foo(p1, ..., pk)</code> to execute the given <code>statements</code>.</td>
</tr>
</tbody>
</table>
<p>The <code>ACTION*</code> macros cannot be used inside a function or class.</p>
<h1 id="cardinalities">Cardinalities<a class="headerlink" href="#cardinalities" title="Permanent link">&para;</a></h1>
<p>These are used in <code>Times()</code> to specify how many times a mock function will be called:</p>
<table>
<thead>
<tr>
<th align="left">Matcher</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>AnyNumber()</code></td>
<td align="left">The function can be called any number of times.</td>
</tr>
<tr>
<td align="left"><code>AtLeast(n)</code></td>
<td align="left">The call is expected at least <code>n</code> times.</td>
</tr>
<tr>
<td align="left"><code>AtMost(n)</code></td>
<td align="left">The call is expected at most <code>n</code> times.</td>
</tr>
<tr>
<td align="left"><code>Between(m, n)</code></td>
<td align="left">The call is expected between <code>m</code> and <code>n</code> (inclusive) times.</td>
</tr>
<tr>
<td align="left"><code>Exactly(n) or n</code></td>
<td align="left">The call is expected exactly <code>n</code> times. In particular, the call should never happen when <code>n</code> is 0.</td>
</tr>
</tbody>
</table>
<h1 id="expectation-order">Expectation Order<a class="headerlink" href="#expectation-order" title="Permanent link">&para;</a></h1>
<p>By default, the expectations can be matched in <em>any</em> order.  If some
or all expectations must be matched in a given order, there are two
ways to specify it.  They can be used either independently or
together.</p>
<h2 id="the-after-clause">The After Clause<a class="headerlink" href="#the-after-clause" title="Permanent link">&para;</a></h2>
<pre><code class="cpp">using ::testing::Expectation;
...
Expectation init_x = EXPECT_CALL(foo, InitX());
Expectation init_y = EXPECT_CALL(foo, InitY());
EXPECT_CALL(foo, Bar())
    .After(init_x, init_y);
</code></pre>

<p>says that <code>Bar()</code> can be called only after both <code>InitX()</code> and
<code>InitY()</code> have been called.</p>
<p>If you don't know how many pre-requisites an expectation has when you
write it, you can use an <code>ExpectationSet</code> to collect them:</p>
<pre><code class="cpp">using ::testing::ExpectationSet;
...
ExpectationSet all_inits;
for (int i = 0; i &lt; element_count; i++) {
  all_inits += EXPECT_CALL(foo, InitElement(i));
}
EXPECT_CALL(foo, Bar())
    .After(all_inits);
</code></pre>

<p>says that <code>Bar()</code> can be called only after all elements have been
initialized (but we don't care about which elements get initialized
before the others).</p>
<p>Modifying an <code>ExpectationSet</code> after using it in an <code>.After()</code> doesn't
affect the meaning of the <code>.After()</code>.</p>
<h2 id="sequences">Sequences<a class="headerlink" href="#sequences" title="Permanent link">&para;</a></h2>
<p>When you have a long chain of sequential expectations, it's easier to
specify the order using <strong>sequences</strong>, which don't require you to given
each expectation in the chain a different name.  <i>All expected<br>
calls</i> in the same sequence must occur in the order they are
specified.</p>
<pre><code class="cpp">using ::testing::Sequence;
Sequence s1, s2;
...
EXPECT_CALL(foo, Reset())
    .InSequence(s1, s2)
    .WillOnce(Return(true));
EXPECT_CALL(foo, GetSize())
    .InSequence(s1)
    .WillOnce(Return(1));
EXPECT_CALL(foo, Describe(A&lt;const char*&gt;()))
    .InSequence(s2)
    .WillOnce(Return(&quot;dummy&quot;));
</code></pre>

<p>says that <code>Reset()</code> must be called before <em>both</em> <code>GetSize()</code> <em>and</em>
<code>Describe()</code>, and the latter two can occur in any order.</p>
<p>To put many expectations in a sequence conveniently:</p>
<pre><code class="cpp">using ::testing::InSequence;
{
  InSequence dummy;

  EXPECT_CALL(...)...;
  EXPECT_CALL(...)...;
  ...
  EXPECT_CALL(...)...;
}
</code></pre>

<p>says that all expected calls in the scope of <code>dummy</code> must occur in
strict order. The name <code>dummy</code> is irrelevant.)</p>
<h1 id="verifying-and-resetting-a-mock">Verifying and Resetting a Mock<a class="headerlink" href="#verifying-and-resetting-a-mock" title="Permanent link">&para;</a></h1>
<p>Google Mock will verify the expectations on a mock object when it is destructed, or you can do it earlier:</p>
<pre><code class="cpp">using ::testing::Mock;
...
// Verifies and removes the expectations on mock_obj;
// returns true iff successful.
Mock::VerifyAndClearExpectations(&amp;mock_obj);
...
// Verifies and removes the expectations on mock_obj;
// also removes the default actions set by ON_CALL();
// returns true iff successful.
Mock::VerifyAndClear(&amp;mock_obj);
</code></pre>

<p>You can also tell Google Mock that a mock object can be leaked and doesn't
need to be verified:</p>
<pre><code class="cpp">Mock::AllowLeak(&amp;mock_obj);
</code></pre>

<h1 id="mock-classes">Mock Classes<a class="headerlink" href="#mock-classes" title="Permanent link">&para;</a></h1>
<p>Google Mock defines a convenient mock class template</p>
<pre><code class="cpp">class MockFunction&lt;R(A1, ..., An)&gt; {
 public:
  MOCK_METHODn(Call, R(A1, ..., An));
};
</code></pre>

<p>See this <a href="../cook_book/#using-check-points">recipe</a> for one application of it.</p>
<h1 id="flags">Flags<a class="headerlink" href="#flags" title="Permanent link">&para;</a></h1>
<table>
<thead>
<tr>
<th align="left">Flag</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>--gmock_catch_leaked_mocks=0</code></td>
<td align="left">Don't report leaked mock objects as failures.</td>
</tr>
<tr>
<td align="left"><code>--gmock_verbose=LEVEL</code></td>
<td align="left">Sets the default verbosity level (<code>info</code>, <code>warning</code>, or <code>error</code>) of Google Mock messages.</td>
</tr>
</tbody>
</table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/application.a353778b.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../../.."}})</script>
      
    
  </body>
</html>