



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.3.0">
    
    
      
        <title>Design doc - Google Docs Mirror</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/application.572ca0f0.css">
      
      
    
    
      <script src="../../../../assets/javascripts/modernizr.962652e9.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#macros-for-defining-actions" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../.." title="Google Docs Mirror" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Google Docs Mirror
              </span>
              <span class="md-header-nav__topic">
                Design doc
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/google/googletest" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Google Test
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../.." title="Google Docs Mirror" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Google Docs Mirror
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/google/googletest" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Google Test
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Google Test
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Google Test
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/Documentation/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/primer/" title="Primer" class="md-nav__link">
      Primer
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/faq/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/advanced/" title="Advanced" class="md-nav__link">
      Advanced
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/XcodeGuide.md" title="Xcode" class="md-nav__link">
      Xcode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/PumpManual.md" title="Pump" class="md-nav__link">
      Pump
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/Pkgconfig.md" title="pkg-config" class="md-nav__link">
      pkg-config
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../googletest/docs/samples/" title="Samples" class="md-nav__link">
      Samples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Google Mock
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Google Mock
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Documentation.md" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ForDummies.md" title="For Dummies" class="md-nav__link">
      For Dummies
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CheatSheet.md" title="Cheat Sheet" class="md-nav__link">
      Cheat Sheet
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CookBook.md" title="Cookbook" class="md-nav__link">
      Cookbook
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../FrequentlyAskedQuestions.md" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../KnownIssues.md" title="Known Issues" class="md-nav__link">
      Known Issues
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../DesignDoc.md" title="Design Doc" class="md-nav__link">
      Design Doc
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem" title="Problem" class="md-nav__link">
    Problem
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solution" title="Solution" class="md-nav__link">
    Solution
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <p>This page discusses the design of new Google Mock features.</p>
<h1 id="macros-for-defining-actions">Macros for Defining Actions<a class="headerlink" href="#macros-for-defining-actions" title="Permanent link">&para;</a></h1>
<h2 id="problem">Problem<a class="headerlink" href="#problem" title="Permanent link">&para;</a></h2>
<p>Due to the lack of closures in C++, it currently requires some
non-trivial effort to define a custom action in Google Mock.  For
example, suppose you want to "increment the value pointed to by the
second argument of the mock function and return it", you could write:</p>
<pre><code class="cpp">int IncrementArg1(Unused, int* p, Unused) {
  return ++(*p);
}

... WillOnce(Invoke(IncrementArg1));
</code></pre>

<p>There are several things unsatisfactory about this approach:</p>
<ul>
<li>Even though the action only cares about the second argument of the mock function, its definition needs to list other arguments as dummies.  This is tedious.</li>
<li>The defined action is usable only in mock functions that takes exactly 3 arguments - an unnecessary restriction.</li>
<li>To use the action, one has to say <code>Invoke(IncrementArg1)</code>, which isn't as nice as <code>IncrementArg1()</code>.</li>
</ul>
<p>The latter two problems can be overcome using <code>MakePolymorphicAction()</code>,
but it requires much more boilerplate code:</p>
<pre><code class="cpp">class IncrementArg1Action {
 public:
  template &lt;typename Result, typename ArgumentTuple&gt;
  Result Perform(const ArgumentTuple&amp; args) const {
    return ++(*tr1::get&lt;1&gt;(args));
  }
};

PolymorphicAction&lt;IncrementArg1Action&gt; IncrementArg1() {
  return MakePolymorphicAction(IncrementArg1Action());
}

... WillOnce(IncrementArg1());
</code></pre>

<p>Our goal is to allow defining custom actions with the least amount of
boiler-plate C++ requires.</p>
<h2 id="solution">Solution<a class="headerlink" href="#solution" title="Permanent link">&para;</a></h2>
<p>We propose to introduce a new macro:</p>
<pre><code class="cpp">ACTION(name) { statements; }
</code></pre>

<p>Using this in a namespace scope will define an action with the given
name that executes the statements.  Inside the statements, you can
refer to the K-th (0-based) argument of the mock function as <code>argK</code>.
For example:</p>
<pre><code class="cpp">ACTION(IncrementArg1) { return ++(*arg1); }
</code></pre>

<p>allows you to write</p>
<pre><code class="cpp">... WillOnce(IncrementArg1());
</code></pre>

<p>Note that you don't need to specify the types of the mock function
arguments, as brevity is a top design goal here.  Rest assured that
your code is still type-safe though: you'll get a compiler error if
<code>*arg1</code> doesn't support the <code>++</code> operator, or if the type of
<code>++(*arg1)</code> isn't compatible with the mock function's return type.</p>
<p>Another example:</p>
<pre><code class="cpp">ACTION(Foo) {
  (*arg2)(5);
  Blah();
  *arg1 = 0;
  return arg0;
}
</code></pre>

<p>defines an action <code>Foo()</code> that invokes argument #2 (a function pointer)
with 5, calls function <code>Blah()</code>, sets the value pointed to by argument</p>
<h1 id="1-to-0-and-returns-argument-0">1 to 0, and returns argument #0.<a class="headerlink" href="#1-to-0-and-returns-argument-0" title="Permanent link">&para;</a></h1>
<p>For more convenience and flexibility, you can also use the following
pre-defined symbols in the body of <code>ACTION</code>:</p>
<table>
<thead>
<tr>
<th align="left">Argument</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>argK_type</code></td>
<td align="left">The type of the K-th (0-based) argument of the mock function</td>
</tr>
<tr>
<td align="left"><code>args</code></td>
<td align="left">All arguments of the mock function as a tuple</td>
</tr>
<tr>
<td align="left"><code>args_type</code></td>
<td align="left">The type of all arguments of the mock function as a tuple</td>
</tr>
<tr>
<td align="left"><code>return_type</code></td>
<td align="left">The return type of the mock function</td>
</tr>
<tr>
<td align="left"><code>function_type</code></td>
<td align="left">The type of the mock function</td>
</tr>
</tbody>
</table>
<p>For example, when using an <code>ACTION</code> as a stub action for mock function:</p>
<pre><code class="cpp">int DoSomething(bool flag, int* ptr);
</code></pre>

<p>we have:</p>
<table>
<thead>
<tr>
<th align="left"><strong>Pre-defined Symbol</strong></th>
<th align="left"><strong>Is Bound To</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>arg0</code></td>
<td align="left">the value of <code>flag</code></td>
</tr>
<tr>
<td align="left"><code>arg0_type</code></td>
<td align="left">the type <code>bool</code></td>
</tr>
<tr>
<td align="left"><code>arg1</code></td>
<td align="left">the value of <code>ptr</code></td>
</tr>
<tr>
<td align="left"><code>arg1_type</code></td>
<td align="left">the type <code>int*</code></td>
</tr>
<tr>
<td align="left"><code>args</code></td>
<td align="left">the tuple <code>(flag, ptr)</code></td>
</tr>
<tr>
<td align="left"><code>args_type</code></td>
<td align="left">the type <code>std::tr1::tuple&lt;bool, int*&gt;</code></td>
</tr>
<tr>
<td align="left"><code>return_type</code></td>
<td align="left">the type <code>int</code></td>
</tr>
<tr>
<td align="left"><code>function_type</code></td>
<td align="left">the type <code>int(bool, int*)</code></td>
</tr>
</tbody>
</table>
<h2 id="parameterized-actions">Parameterized actions<a class="headerlink" href="#parameterized-actions" title="Permanent link">&para;</a></h2>
<p>Sometimes you'll want to parameterize the action.   For that we propose
another macro</p>
<pre><code class="cpp">ACTION_P(name, param) { statements; }
</code></pre>

<p>For example,</p>
<pre><code class="cpp">ACTION_P(Add, n) { return arg0 + n; }
</code></pre>

<p>will allow you to write</p>
<pre><code class="cpp">// Returns argument #0 + 5.
... WillOnce(Add(5));
</code></pre>

<p>For convenience, we use the term <em>arguments</em> for the values used to
invoke the mock function, and the term <em>parameters</em> for the values
used to instantiate an action.</p>
<p>Note that you don't need to provide the type of the parameter either.
Suppose the parameter is named <code>param</code>, you can also use the
Google-Mock-defined symbol <code>param_type</code> to refer to the type of the
parameter as inferred by the compiler.</p>
<p>We will also provide <code>ACTION_P2</code>, <code>ACTION_P3</code>, and etc to support
multi-parameter actions.  For example,</p>
<pre><code class="cpp">ACTION_P2(ReturnDistanceTo, x, y) {
  double dx = arg0 - x;
  double dy = arg1 - y;
  return sqrt(dx*dx + dy*dy);
}
</code></pre>

<p>lets you write</p>
<pre><code class="cpp">... WillOnce(ReturnDistanceTo(5.0, 26.5));
</code></pre>

<p>You can view <code>ACTION</code> as a degenerated parameterized action where the
number of parameters is 0.</p>
<h2 id="advanced-usages">Advanced Usages<a class="headerlink" href="#advanced-usages" title="Permanent link">&para;</a></h2>
<h3 id="overloading-actions">Overloading Actions<a class="headerlink" href="#overloading-actions" title="Permanent link">&para;</a></h3>
<p>You can easily define actions overloaded on the number of parameters:</p>
<pre><code class="cpp">ACTION_P(Plus, a) { ... }
ACTION_P2(Plus, a, b) { ... }
</code></pre>

<h3 id="restricting-the-type-of-an-argument-or-parameter">Restricting the Type of an Argument or Parameter<a class="headerlink" href="#restricting-the-type-of-an-argument-or-parameter" title="Permanent link">&para;</a></h3>
<p>For maximum brevity and reusability, the <code>ACTION*</code> macros don't let
you specify the types of the mock function arguments and the action
parameters.  Instead, we let the compiler infer the types for us.</p>
<p>Sometimes, however, we may want to be more explicit about the types.
There are several tricks to do that.  For example:</p>
<pre><code class="cpp">ACTION(Foo) {
  // Makes sure arg0 can be converted to int.
  int n = arg0;
  ... use n instead of arg0 here ...
}

ACTION_P(Bar, param) {
  // Makes sure the type of arg1 is const char*.
  ::testing::StaticAssertTypeEq&lt;const char*, arg1_type&gt;();

  // Makes sure param can be converted to bool.
  bool flag = param;
}
</code></pre>

<p>where <code>StaticAssertTypeEq</code> is a compile-time assertion we plan to add to
Google Test (the name is chosen to match <code>static_assert</code> in C++0x).</p>
<h3 id="using-the-action-objects-type">Using the ACTION Object's Type<a class="headerlink" href="#using-the-action-objects-type" title="Permanent link">&para;</a></h3>
<p>If you are writing a function that returns an <code>ACTION</code> object, you'll
need to know its type.  The type depends on the macro used to define
the action and the parameter types.  The rule is relatively simple:
| <strong>Given Definition</strong>     | <strong>Expression</strong>               | <strong>Has Type</strong>             |
|:-------------------------|:-----------------------------|:-------------------------|
| <code>ACTION(Foo)</code>            | <code>Foo()</code>                      | <code>FooAction</code>              |
| <code>ACTION_P(Bar, param)</code>   | <code>Bar(int_value)</code>             | <code>BarActionP&lt;int&gt;</code>        |
| <code>ACTION_P2(Baz, p1, p2)</code> | <code>Baz(bool_value, int_value)</code> | <code>BazActionP2&lt;bool, int&gt;</code> |
| ...                      | ...                          | ...                      |</p>
<p>Note that we have to pick different suffixes (<code>Action</code>, <code>ActionP</code>,
<code>ActionP2</code>, and etc) for actions with different numbers of parameters,
or the action definitions cannot be overloaded on the number of
parameters.</p>
<h2 id="when-to-use">When to Use<a class="headerlink" href="#when-to-use" title="Permanent link">&para;</a></h2>
<p>While the new macros are very convenient, please also consider other
means of implementing actions (e.g. via <code>ActionInterface</code> or
<code>MakePolymorphicAction()</code>), especially if you need to use the defined
action a lot.  While the other approaches require more work, they give
you more control on the types of the mock function arguments and the
action parameters, which in general leads to better compiler error
messages that pay off in the long run.  They also allow overloading
actions based on parameter types, as opposed to just the number of
parameters.</p>
<h2 id="related-work">Related Work<a class="headerlink" href="#related-work" title="Permanent link">&para;</a></h2>
<p>As you may have realized, the <code>ACTION*</code> macros resemble closures (also
known as lambda expressions or anonymous functions).  Indeed, both of
them seek to lower the syntactic overhead for defining a function.</p>
<p>C++0x will support lambdas, but they are not part of C++ right now.
Some non-standard libraries (most notably BLL or Boost Lambda Library)
try to alleviate this problem.  However, they are not a good choice
for defining actions as:</p>
<ul>
<li>They are non-standard and not widely installed.  Google Mock only depends on standard libraries and <code>tr1::tuple</code>, which is part of the new C++ standard and comes with gcc 4+.  We want to keep it that way.</li>
<li>They are not trivial to learn.</li>
<li>They will become obsolete when C++0x's lambda feature is widely supported.  We don't want to make our users use a dying library.</li>
<li>Since they are based on operators, they are rather ad hoc: you cannot use statements, and you cannot pass the lambda arguments to a function, for example.</li>
<li>They have subtle semantics that easily confuses new users.  For example, in expression <code>_1++ + foo++</code>, <code>foo</code> will be incremented only once where the expression is evaluated, while <code>_1</code> will be incremented every time the unnamed function is invoked.  This is far from intuitive.</li>
</ul>
<p><code>ACTION*</code> avoid all these problems.</p>
<h2 id="future-improvements">Future Improvements<a class="headerlink" href="#future-improvements" title="Permanent link">&para;</a></h2>
<p>There may be a need for composing <code>ACTION*</code> definitions (i.e. invoking
another <code>ACTION</code> inside the definition of one <code>ACTION*</code>).  We are not
sure we want it yet, as one can get a similar effect by putting
<code>ACTION</code> definitions in function templates and composing the function
templates.  We'll revisit this based on user feedback.</p>
<p>The reason we don't allow <code>ACTION*()</code> inside a function body is that
the current C++ standard doesn't allow function-local types to be used
to instantiate templates.  The upcoming C++0x standard will lift this
restriction.  Once this feature is widely supported by compilers, we
can revisit the implementation and add support for using <code>ACTION*()</code>
inside a function.</p>
<p>C++0x will also support lambda expressions.  When they become
available, we may want to support using lambdas as actions.</p>
<h1 id="macros-for-defining-matchers">Macros for Defining Matchers<a class="headerlink" href="#macros-for-defining-matchers" title="Permanent link">&para;</a></h1>
<p>Once the macros for defining actions are implemented, we plan to do
the same for matchers:</p>
<pre><code class="cpp">MATCHER(name) { statements; }
</code></pre>

<p>where you can refer to the value being matched as <code>arg</code>.  For example,
given:</p>
<pre><code class="cpp">MATCHER(IsPositive) { return arg &gt; 0; }
</code></pre>

<p>you can use <code>IsPositive()</code> as a matcher that matches a value iff it is
greater than 0.</p>
<p>We will also add <code>MATCHER_P</code>, <code>MATCHER_P2</code>, and etc for parameterized
matchers.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/application.a353778b.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../../.."}})</script>
      
    
  </body>
</html>